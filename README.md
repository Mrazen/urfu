# urfu

for test

1. На server2 добавляем vhost с проксированием к server1.На server1 запускаем backend приложение, пример привёл в папке node.js

$ node app.js
Запускаем nginx на server1 для работы со статикой.
Запросы поступающие на прокси-сервер, с указанием определённого доменного имени, будут перенаправляться
на server1 по соотвествующим URI.

Примеры конфигурационных файлов приведены в папке 1.
Если использовать кастомные сабдомены, то достаточно перенаправлять только 80ый порт(или 443 для https) из DMZ.

Так же всё можно развернуть используя Docker. Файлы конфигурация приведены в папках проектов. Конфигурационные файл Nginx копируется внуть образа, как и статический контент. Так же приведён docker-compose.

2. На Jenkins настраивается job, который мониторит определённую ветку в git(vcs). Устанавливается триггер срабатывающий при коммите. Job забирает исходные файлы с git, копирует их через SSH на нужный сервер. В момент копирования, файлы могут быть недоступны по запросам от пользователей. Пример Jenkinsfile для pipeline привёл в папке 2.

3. SQL Server должен использовать учётную запись с правами доступа к сетевой директории \\server2\rk\
Через T-SQL запрос

BACKUP DATABASE database.
   TO DISK = '\\server2\rk\database.bak';  
GO

#Проверяем на наличие ошибок при передаче через сеть
   RESTORE VERIFYONLY FROM DISK = '\\server2\rk\database.bak';
GO  

Или через Managment Studio
Задачи ---> Создать резервную копию

4. Полный бэкап системы 150 Гб раз в 10 дней.Разностная копия 500 Мб за каждый день. Используется подход смешанного разностного копирования. Создаются цепочки разностных копий, из условия задачи их будет 10, по одной на каждый день. Первоначальная цепочка будет занимать порядка 177.5 Гб + ~0,5% за каждый день, что в сумме даст ~187Гб. При замене с удалением предыдущей цепочки на новую получается приращение ~ 10Гб за период в 10 дней. С учётом первоначального обёма резервных копий получается 520 дней. Так как расчёты имеют приблизительный характер, то лучше взять большую погрешность вычислений в 10%, что в итоге составит 468 дней.

5. Возможно развернуть на обширом семействе ОС Linux(Ubuntu, CentOS, ...) Потребуются, собственно, php 7.3 и MariaDB 10.5.1. Часто входят в состав дистрибутивов. Устанавливаются в зависимости от пакетного менеджера данной ОС. Для RHEL семейства требуется добавление репозитория Remi. 

rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm
dnf install -y https://rpms.remirepo.net/enterprise/remi-release-8.rpm
dnf module enable php:remi-7.3 -y
dnf install -y php php-cli php-common
#Поддержка MySQL в php
dnf install -y php-mysqlnd

Альтернативный способ разворачивания приложения через Docker. Примеры конфигураций привёл в GitHub.

6. Нужно создать точку монтирования с использованием протокола CIFS
apt-get install cifs-utils

#Монтируем
mount.cifs //RK/db /mnt -o user=mysql_bkp, pass=mypass
#Используем утилиту mysqldump
mysqldump -h localhost -u root -p mydb > /mnt/mydb.sql

7. 